<link rel="stylesheet" th:href="@{/css/product/view.css}">
<link rel="stylesheet" th:href="@{/css/basic.css}">
<header th:replace="layout/main/header.html"></header>
<script th:src="@{/js/main.js}"></script>
<main style="margin-top: 230px; gap: 0">
    <aside th:replace="layout/main/aside.html" style="margin: 0; margin-right: 30px"></aside>
    <div id="wrap">
        <!-- .aside -->
        <main id="main" style="height: auto;">
            <nav id="navi" style="width: 810px">
                <h2 class="sub_tit">상품보기</h2>
                <p class="location">
                    <span>[[${location.level1Name}]]</span>
                    <span>[[${location.level2Name}]]</span>
                    <span>[[${location.level3Name}]]</span>
                </p>
            </nav> <!-- #navi-->
            <div class="product_info">
                <img th:src="@{'/file/'+${product.getProdBasicImg()}}" alt="">
                <div class="product_details">
                    <form th:action="@{/prod/cart}" method="POST" id="productForm">
                        <table class="tb1">
                            <tr>
                                <td class="td_company">
                                    <span>[[${product.getSellCompany}]]</span>
                                    <span>상품번호 : [[${product.getId}]]</span>
                                    <input type="hidden" th:value="${product.getId}" name="prodId">
                                    <span style="
                                        cursor: pointer;
                                        color: red;
                                        border: 1px solid black;
                                        padding: 2px 4px;
                                     " th:if="${couponId != 0}" th:data-id="${couponId}" onclick="getCustomerCoupon(event)">쿠폰 발급받기</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="prod_name">
                                    <span>[[${product.getProdName}]]</span> <br>
                                    <img src="https://via.placeholder.com/56x17" alt="별점">
                                    <a href="#prodReview">상품평보기</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="price">
                                    <del>[[${#numbers.formatInteger(product.getProdPrice(), 1)}]]원&nbsp;</del>
                                    <span>[[${#numbers.formatInteger(product.getProdDiscount(), 1)}]]%&#8595;</span>
                                    <img src="https://via.placeholder.com/33x17" alt="별점">
                                    <span th:if="${prodDetail.installmentable}">무이자할부</span>
                                    <span th:unless="${prodDetail.installmentable}">할부(무이자X)</span>
                                    <img src="https://via.placeholder.com/33x17" alt="별점">
                                    <span>카드 추가 혜택</span> <br>
                                    <span id="finalPrice">[[${#numbers.formatInteger(product.getTotalPrice(), 1)}]]원</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="delivery">
                                    <span th:text="'배송비 : ' + ${product.prodDeliver > 0 ? product.prodDeliver + '원' : '무료배송'}"></span>
                                    <span id="delivery-date"></span> <br>
                                    <span th:if="${prodDetail.deliable}">본상품은 해외배송이 가능합니다.</span>
                                    <span th:unless="${prodDetail.deliable}">본상품은 국내배송만 가능합니다</span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <span class="des">원산지 - [[${prodDetail.origin}]]</span>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <select name="options" class="prodOptions" id="select1">
                                        <option value="">Select an Option</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="display: none">
                                    <select name="options" class="prodOptions" id="select2">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="display: none">
                                    <select name="options" class="prodOptions" id="select3">
                                    </select>
                                    <input type="hidden" id="optionId" name="optionId" value="">
                                    <input type="hidden" id="optionStock" value="">
                                </td>
                            </tr>
                            <tr class="count_qty">
                                <td style="float: right; display: none;" id="qty">
                                    <span class="qty">수량 </span>
                                    <button type="button" class="decrement">-</button> <!-- 감소 버튼 -->
                                    <input name="quantity" type="number" class="count" value="1" min="1"/>
                                    <button type="button" class="increment">+</button> <!-- 증가 버튼 -->
                                </td>
                            </tr>
                            <tr>
                                <td class="total">
                                    <span>총 상품 금액 </span>
                                    <span name="totalPrice" id="totalPrice">[[${#numbers.formatInteger(product.getTotalPrice(), 1)}]]원</span>
                                </td>
                            </tr>
                        </table> <!-- .tb1-->
                        <div class="buttons">
                            <button type="submit" class="cart" onclick="cartBtn()">장바구니</button>
                            <button type="button" class="btnorder"><a> 구매하기</a></button>
                        </div> <!-- .buttons -->
                    </form>
                </div> <!-- .product_details -->
            </div> <!-- .product_info -->
            <div class="view_banner">
                <img src="https://via.placeholder.com/550x64" alt="상품 상세보기 배너">
            </div>
            <h2 class="sub_tit2">상품보기</h2>
            <div class="detail_image">
                <img th:src="@{'/file/'+${prodDetail.getDescription()}}" alt="상품 상세보기 이미지">
            </div> <!-- .detail_image-->
            <h2 class="sub_tit3">
                상품정보 제공고시
                <span>[전자상거래에 관한 상품정보 제공에 관한 고시]항목에 의거 등록된 정보입니다.</span>
            </h2>
            <table class="tb2">
                <colgroup>
                    <col style="width: 40%;">
                    <col style="width: 60%;">
                </colgroup>
                <tr>
                    <th>상품번호</th>
                    <td>[[${prodDetail.productId}]]</td>
                </tr>
                <tr>
                    <th>상품상태</th>
                    <td>[[${prodDetail.stat}]]</td>
                </tr>
                <tr>
                    <th>부가세면세여부</th>
                    <td th:if="${prodDetail.tax}">과세상품</td>
                    <td th:unless="${prodDetail.tax}">비과세상품</td>
                </tr>
                <tr>
                    <th>영수증 발행</th>
                    <td>발행가능신용카드전표, 온라인 현금영수증</td>
                </tr>
                <tr>
                    <th>사업자 구분</th>
                    <td>통신판매업자</td>
                </tr>
                <tr>
                    <th>브랜드</th>
                    <td>[[${product.seller.sellCompany}]]</td>
                </tr>
                <tr>
                    <th>원산지</th>
                    <td>[[${prodDetail.origin}]]</td>
                </tr>
            </table> <!-- tb2 -->
            <table class="tb3">
                <colgroup>
                    <col style="width: 40%;">
                    <col style="width: 60%;">
                </colgroup>
                <tr>
                    <th>제조사/수입국</th>
                    <td>[[${prodDetail.manufacture}]]</td>
                </tr>
                <tr>
                    <th>제조국</th>
                    <td>[[${prodDetail.madein}]]</td>
                </tr>
                <tr>
                    <th>취급시 주의사항</th>
                    <td>[[${prodDetail.caution}]]</td>
                </tr>
                <tr>
                    <th>제조연월</th>
                    <td th:text="${#dates.format(prodDetail.mdate, 'yyyy-MM-dd')}"></td>
                </tr>
                <tr>
                    <th>품질보증기간</th>
                    <td>[[${prodDetail.warranty}]]</td>
                </tr>
                <tr>
                    <th>A/S 책임자</th>
                    <td>[[${product.seller.sellRepresentative}]]</td>
                </tr>
                <tr>
                    <th>전화번호</th>
                    <td>[[${product.seller.sellHp}]]</td>
                </tr>
            </table> <!-- tb3 -->
            <div class="refund">
                <span>소비자가 전자상거래등에서 소비자 보호에 관한 법률 제 17조 1항 또는 제 3항에 따라 청약철회를 하고
                동법 제 18조 제 1항에 다라 청약철회한 물품을 판매자에게 반환하였음에도 불구하고 결제 대금의 환급이
                3영업일을 넘게 지연된 경우, 소비자는 전자상거래등에서 소비자보호에 관한 법률 제 18조 제 2항 및 동법 시행령 제 21조 2에
                따라 지연일수에 대하여 전상법 시행령으로 정하는 이율을 곱하여 산정한 지연이자("지연배상금")를 신청할 수 있습니다.
                아울러, 교환반품보증 및 결제대금의 환급신청은 [나의 쇼핑정보]에서 하실 수 있으며, 자세한 문의는
                개별 판매자에게 연락하여 주시기 바랍니다.</span>
            </div> <!-- .refund-->
            <h2 class="sub_tit4">상품리뷰</h2>
            <div class="cmt" id="prodReview">
                <img src="https://via.placeholder.com/78x20"> <br>
                <span>상품명</span>
                <span>2024-10-13</span>
                <span>nickn*ame </span><br>
                <span>후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~후기 남깁니다~</span>
            </div>
            <div class="page" style="margin: 0 auto;">
                <a href="#">&lt; 이전</a>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>4</button>
                <button>5</button>
                <a href="#">다음 &gt;</a>
            </div> <!-- page -->
        </main> <!-- #main-->
    </div>
    <input type="hidden" th:value="${options}" id="hiddenOption">
</main>
<footer th:replace="layout/main/footer.html"></footer>
<!-- #wrap -->
<script>
    async function getCustomerCoupon(event){
        const submitData = {
            'id' : event.target.dataset.id
        }
        console.log(submitData)
        try {
            const resp = await axios.post("/prod/customer/coupon",submitData,{
                headers : {
                    "Content-Type" : "application/json"
                }
            })
            alert(resp.data)

        } catch (e) {
            alert("로그인이 필요합니다.")
            window.location.href = "/auth/login/view"
        }
    }

    // 요일명을 저장한 배열
    const days = ["일", "월", "화", "수", "목", "금", "토"];

    // 오늘을 기준으로 3일 뒤의 날짜를 계산하는 함수
    function getDeliveryDate() {
        const today = new Date();
        const deliveryDate = new Date(today);
        const deliveryDate2 = new Date(today);

        // 3일 뒤로 설정

        deliveryDate.setDate(today.getDate() + 3);

        // 요일 구하기
        const dayOfWeek = days[deliveryDate.getDay()];

        // 날짜 형식 만들기 (예: "7/8")
        const month = deliveryDate.getMonth() + 1; // getMonth()는 0부터 시작하므로 +1 필요
        const date = deliveryDate.getDate();
        if([[${prodDetail.deliable}]]){
            return `(${dayOfWeek}) ${month}/${date} 도착예정 (해외배송은 +3~5일)`;
        }else{
            return `(${dayOfWeek}) ${month}/${date} 도착예정`;
        }
    }

    // HTML에 날짜 값 삽입
    document.getElementById("delivery-date").innerText = getDeliveryDate();

    // 수량 증감 버튼 구현하기
    const decrementButton = document.querySelector('.decrement');
    const incrementButton = document.querySelector('.increment');
    const countInput = document.querySelector('.count');

    // 감소 버튼 클릭 시 수량 감소
    decrementButton.addEventListener('click', () => {
        let currentValue = parseInt(countInput.value);
        if (currentValue > parseInt(countInput.min)) {
            countInput.value = currentValue - 1;
            countInput.dispatchEvent(new Event('change')); // change 이벤트 발생
        }
    });

    // 증가 버튼 클릭 시 수량 증가
    incrementButton.addEventListener('click', () => {
        let currentValue = parseInt(countInput.value);
        let maxValue = parseInt(countInput.max); // max 값을 사용하지 않으므로 따로 처리하지 않음

        // max 값이 없거나 현재 값이 max 보다 작다면 증가
        if (!maxValue || currentValue < maxValue) {
            countInput.value = currentValue + 1;
            countInput.dispatchEvent(new Event('change')); // change 이벤트 발생
        }
    });

    window.onload = function () {
        let totalPrice = document.getElementById('totalPrice');
        let basePrice = parseFloat([[${#numbers.formatInteger(product.getTotalPrice(), 1)}]]); // 기본 가격
        let selectedAdditionalPrice = 0; // 선택된 추가 가격 초기화
        let selectedOptionId = null; // 선택된 옵션 ID 초기화
        const qty = document.getElementById('qty');

        countInput.addEventListener('change', function () {
            calculateTotalPrice();
        });

        let option = document.getElementById('hiddenOption').value.trim();
        option = option.replace(/^\[|\PostProductOptionDTO|\]$/g, '').trim();
        console.log(option);
        if(option === ''){
            qty.style.display = 'table-cell';
        }

        function splitDataByParentheses(data) {
            const splitData = data.split("),");
            const cleanedData = splitData.map((item, index) => {
                return index !== splitData.length - 1 ? item + ")" : item;
            });
            return cleanedData;
        }

        const splitResult = splitDataByParentheses(option);
        function extractOptionValue(dataArray, keyName) {
            return dataArray.map(item => {
                const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                const foundPair = keyValuePairs.find(pair => pair[0].trim() === keyName);
                return foundPair ? foundPair[1] : null;
            }).filter(value => value !== null);
        }

        const optionValues = Array.from(new Set(extractOptionValue(splitResult, 'optionValue')));
        const optionIds = Array.from(new Set(extractOptionValue(splitResult, 'id')));
        const optionNames = Array.from(new Set(extractOptionValue(splitResult, 'optionName'))); // optionName2 추출
        const selectElement1 = document.getElementById('select1');
        selectElement1.innerHTML = `<option value="">${optionNames[0] || "Select an Option"}</option>`;

        if (optionNames[0] === '옵션없음') {
            qty.style.display = 'table-cell';
            document.getElementById('optionId').value = optionIds[0];
        }else{
            optionValues.forEach(value => {
                const optionElement = document.createElement('option');
                optionElement.textContent = value;
                optionElement.value = value;
                selectElement1.appendChild(optionElement);
           });
        }

        selectElement1.addEventListener('change', function () {
            const selectedValue1 = selectElement1.value;
            const parentTd = document.getElementById('select2').parentNode;
            parentTd.style.display = 'none';
            const parentTd2 = document.getElementById('select3').parentNode;
            parentTd2.style.display = 'none';
            const filteredData = splitResult.filter(item => {
                const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                const foundPair = keyValuePairs.find(pair => pair[0].trim() === 'optionValue');
                return foundPair && foundPair[1] === selectedValue1;
            });

            filteredData.forEach(item => {
                const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                const optionValue2Pair = keyValuePairs.find(pair => pair[0].trim() === 'optionValue2');
                const additionalPricePair = keyValuePairs.find(pair => pair[0].trim() === 'additionalPrice');
                const optionIdPair = keyValuePairs.find(pair => pair[0].trim() === 'id');
                const optionId = optionIdPair ? optionIdPair[1] : null;
                const optionStockPair =keyValuePairs.find(pair => pair[0].trim() === 'stock');
                const optionStock = optionStockPair ? optionStockPair[1] : null;
                // optionValue2가 null인 경우 추가 요금 포함
                if (optionValue2Pair && optionValue2Pair[1] === 'null' && additionalPricePair) {
                    const additionalPrice = parseFloat(additionalPricePair[1]) || 0;
                    const additionalPriceFormatted = additionalPrice.toLocaleString(); // 포맷팅
                    selectedAdditionalPrice = additionalPriceFormatted.replace(',', '');
                    console.log(selectedAdditionalPrice);
                    calculateTotalPrice();
                    // 선택된 옵션의 텍스트를 업데이트
                    const selectedOption = selectElement1.querySelector(`option[value="${selectedValue1}"]`);
                    if (selectedOption) {
                        if(additionalPriceFormatted.charAt(0) === '-'){
                            selectedOption.textContent = `${selectedOption.value} (${additionalPriceFormatted}원)`;
                        }else{
                        selectedOption.textContent = `${selectedOption.value} (+${additionalPriceFormatted}원)`;
                        }
                        document.getElementById('optionId').value = optionId;
                        console.log("id"+document.getElementById('optionId').value);
                        document.getElementById('optionStock').value = optionStock;
                        console.log("stock"+document.getElementById('optionStock').value);
                    }
                    const parentTd = document.getElementById('select2').parentNode;
                    parentTd.style.display = 'none';
                    const parentTd2 = document.getElementById('select3').parentNode;
                    parentTd2.style.display = 'none';
                    qty.style.display = 'table-cell';
                }
            });

            const optionValues2 = Array.from(new Set(extractOptionValue(filteredData, 'optionValue2')));
            const optionNames2 = Array.from(new Set(extractOptionValue(filteredData, 'optionName2'))); // optionName2 추출

            const selectElement2 = document.getElementById('select2');
            selectElement2.innerHTML = `<option value="">${optionNames2[0] || "Select an Option"}</option>`;

            optionValues2.forEach((value, index) => {
                const optionElement = document.createElement('option');
                optionElement.textContent = value;
                optionElement.value = value;
                selectElement2.appendChild(optionElement);
                const parentTd = selectElement2.parentNode;
                if (optionElement.value !== "null") {
                    parentTd.style.display = 'table-cell';
                    qty.style.display = 'none';
                }
            });

            selectElement2.addEventListener('change', function () {
                const selectedValue2 = selectElement2.value;

                const filteredData2 = filteredData.filter(item => {
                    const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                    const foundPair = keyValuePairs.find(pair => pair[0].trim() === 'optionValue2');
                    return foundPair && foundPair[1] === selectedValue2;
                });

                filteredData2.forEach(item => {
                    const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                    const optionValue3Pair = keyValuePairs.find(pair => pair[0].trim() === 'optionValue3');
                    const additionalPricePair = keyValuePairs.find(pair => pair[0].trim() === 'additionalPrice');
                    const optionIdPair = keyValuePairs.find(pair => pair[0].trim() === 'id');
                    const optionId = optionIdPair ? optionIdPair[1] : null;
                    const optionStockPair =keyValuePairs.find(pair => pair[0].trim() === 'stock');
                    const optionStock = optionStockPair ? optionStockPair[1] : null;
                    // optionValue3가 null인 경우 추가 요금 포함
                    if (optionValue3Pair && optionValue3Pair[1] === 'null' && additionalPricePair) {
                        const additionalPrice = parseFloat(additionalPricePair[1]) || 0;
                        const additionalPriceFormatted = additionalPrice.toLocaleString(); // 포맷팅
                        selectedAdditionalPrice = additionalPriceFormatted.replace(',', '');
                        calculateTotalPrice();
                        // 선택된 옵션의 텍스트를 업데이트
                        const selectedOption = selectElement2.querySelector(`option[value="${selectedValue2}"]`);
                        if (selectedOption) {
                            selectedOption.textContent = `${selectedOption.value} (+${additionalPriceFormatted}원)`;
                            document.getElementById('optionId').value = optionId;
                            console.log("id"+document.getElementById('optionId').value);
                            document.getElementById('optionStock').value = optionStock;
                            console.log("stock"+document.getElementById('optionStock').value);
                        }
                        const parentTd = document.getElementById('select3').parentNode;
                        parentTd.style.display = 'none';
                        qty.style.display = 'table-cell';
                    }
                });

                const optionValues3 = Array.from(new Set(extractOptionValue(filteredData2, 'optionValue3')));
                const optionNames3 = Array.from(new Set(extractOptionValue(filteredData2, 'optionName3'))); // optionName2 추출
                const additionalPrices = extractKeyValue(filteredData2, 'additionalPrice');
                let addPriceFinal = null;
                const selectElement3 = document.getElementById('select3');
                selectElement3.innerHTML = `<option value="">${optionNames3[0] || "Select an Option"}</option>`;

                optionValues3.forEach((value, index) => {
                    const addPrice = Math.floor(additionalPrices[index]); // 해당 인덱스의 추가 가격
                    const optionElement = document.createElement('option');
                    optionElement.textContent = `${value} (+${addPrice}원)`;
                    optionElement.value = String(index); // 인덱스를 값으로 사용하여 선택 시 해당 인덱스를 가져올 수 있도록 함

                    const parentTd = selectElement3.parentNode;
                    if (value !== "null") {
                        parentTd.style.display = 'table-cell';
                        selectElement3.appendChild(optionElement);
                    }
                });
                selectElement3.addEventListener('change', function () {
                    const selectedIndex = selectElement3.value;
                    if (selectedIndex === "") {
                        // 선택된 값이 없을 때 처리
                        document.getElementById('optionId').value = "";
                        document.getElementById('optionStock').value = "";
                        selectedAdditionalPrice = 0;
                        return;
                    }
                    // 선택된 인덱스를 기반으로 각 값 설정
                    selectedAdditionalPrice = Math.floor(additionalPrices[selectedIndex]);
                    const selectedId = extractKeyValue(filteredData2, 'id')[selectedIndex];
                    const selectedStock = extractKeyValue(filteredData2, 'stock')[selectedIndex];
                    document.getElementById('optionId').value = selectedId;
                    document.getElementById('optionStock').value = selectedStock;
                    console.log("id: " + selectedId);
                    console.log("stock: " + selectedStock);
                    console.log("addPrice: " + selectedAdditionalPrice);

                    qty.style.display = 'table-cell';
                    calculateTotalPrice(); // 총 가격 계산
                });
            });
        });

        function extractKeyValue(dataArray, keyName) {
            return dataArray.map(item => {
                const keyValuePairs = item.replace('(', '').replace(')', '').split(',').map(pair => pair.trim().split('='));
                const foundPair = keyValuePairs.find(pair => pair[0].trim() === keyName);
                return foundPair ? foundPair[1] : null;
            }).filter(value => value !== null);
        }

        // 가격 계산 함수
        function calculateTotalPrice() {
            let inNum = countInput.value || 0; // 수량을 가져오고 기본값 0 설정
            let additionalPriceSum = selectedAdditionalPrice * inNum; // 선택된 추가 가격을 수량과 곱함
            let totalPriceValue = (inNum * basePrice) + additionalPriceSum; // 총 가격 계산
            totalPrice.innerText = totalPriceValue + "원"; // 화면에 표시
            totalPrice.value = totalPriceValue;
        }


        const cart= document.querySelector('.cart');
        const productForm = document.querySelector('#productForm');

        cart.addEventListener('click', async function (e){
            e.preventDefault();
            let readPrice = totalPrice.value
            const optionId = document.getElementById('optionId').value


            if(qty.style.display !== 'table-cell'){
                alert('옵션을 선택해 주세요.');
                return;
            }else{
                readPrice = basePrice;
            }

            const jsonData = {
                "prodId": productForm.prodId.value,
                "quantity":productForm.quantity.value,
                "totalPrice": readPrice,
                "optionId": optionId
            }
            console.log(jsonData)

            const response = await fetch('/prod/cart',{
                method:'POST',
                headers:{
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            });
            if (!response.ok) throw new Error('주문 상세 정보를 불러오지 못했습니다.');

            data = await response.json();

            console.log(data.status);
            if(data.status=='noAuth'){
                alert('로그인 후 이용해주세요.');
                location.replace('/auth/login/view');
            }else if(data.status=='seller'){
                alert('일반 회원으로 이용해 주세요.')
            }else if(data.status=='customer'){
                confirm('장바구니에 담겼습니다. 장바구니로 이동하시겠습니까?') ? location.replace('/prod/cart') : null;
            }

        })

        const btnorder = document.querySelector('.btnorder');

        btnorder.addEventListener('click',async function (e){
            e.preventDefault();

            let readPrice = totalPrice.value
            const optionId = document.getElementById('optionId').value


            if(qty.style.display != 'table-cell'){
                alert('옵션을 선택해 주세요.');
                return;
            }else{
                readPrice = basePrice;
            }

            const jsonData = {
                "productId": productForm.prodId.value,
                "quantity":productForm.quantity.value,
                "totalPrice": readPrice,
                "optionId": optionId
            }
            console.log(jsonData)

            const response = await fetch('/prod/order/direct',{
                method:'POST',
                headers:{
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(jsonData)
            });
            if (!response.ok) throw new Error('주문 상세 정보를 불러오지 못했습니다.');

            data = await response.json();

            console.log(data);
            if(data.status=='noAuth'){
                alert('로그인 후 이용해주세요.');
                location.replace('/auth/login/view');
            }else if(data.status=='seller'){
                alert('일반 회원으로 이용해 주세요.')
            }else if(data.status=='customer'){
                alert('주문서로 이동합니다.');
                location.replace('/prod/order');
            }

        });

    };

</script>